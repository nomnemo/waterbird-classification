
[info] run directory: runs_swin2/swin_mpc1000_ep30_lr0100_wd0100_as1
[info] saved split_composition.json
[info] model: swin_tiny_patch4_window7_224
[info] epochs: 30, lr: 0.0001, weight_decay: 0.01, accum_steps: 1
ep 01 | train acc 0.775 loss 0.739 | val acc 0.843 loss 0.457 | macroF1 0.794 | lr 5.00e-05 | val_time 4.2s | ep_time 28.3s
[info] new best val macro-F1 0.794 at epoch 01
ep 02 | train acc 0.868 loss 0.396 | val acc 0.875 loss 0.397 | macroF1 0.828 | lr 1.00e-04 | val_time 2.4s | ep_time 24.9s
[info] new best val macro-F1 0.828 at epoch 02
ep 03 | train acc 0.898 loss 0.289 | val acc 0.884 loss 0.358 | macroF1 0.850 | lr 9.97e-05 | val_time 2.1s | ep_time 24.4s
[info] new best val macro-F1 0.850 at epoch 03
ep 04 | train acc 0.915 loss 0.244 | val acc 0.898 loss 0.338 | macroF1 0.854 | lr 9.87e-05 | val_time 1.9s | ep_time 24.3s
[info] new best val macro-F1 0.854 at epoch 04
ep 05 | train acc 0.929 loss 0.203 | val acc 0.883 loss 0.341 | macroF1 0.842 | lr 9.72e-05 | val_time 1.9s | ep_time 24.6s
ep 06 | train acc 0.936 loss 0.175 | val acc 0.890 loss 0.371 | macroF1 0.858 | lr 9.50e-05 | val_time 2.0s | ep_time 24.4s
[info] new best val macro-F1 0.858 at epoch 06
ep 07 | train acc 0.943 loss 0.157 | val acc 0.896 loss 0.354 | macroF1 0.869 | lr 9.23e-05 | val_time 2.0s | ep_time 24.2s
[info] new best val macro-F1 0.869 at epoch 07
ep 08 | train acc 0.945 loss 0.157 | val acc 0.905 loss 0.320 | macroF1 0.868 | lr 8.91e-05 | val_time 2.1s | ep_time 24.4s
ep 09 | train acc 0.953 loss 0.122 | val acc 0.897 loss 0.314 | macroF1 0.856 | lr 8.54e-05 | val_time 1.9s | ep_time 24.2s
ep 10 | train acc 0.954 loss 0.128 | val acc 0.917 loss 0.264 | macroF1 0.887 | lr 8.12e-05 | val_time 2.0s | ep_time 24.3s
[info] new best val macro-F1 0.887 at epoch 10
ep 11 | train acc 0.956 loss 0.121 | val acc 0.924 loss 0.255 | macroF1 0.891 | lr 7.66e-05 | val_time 1.9s | ep_time 24.4s
[info] new best val macro-F1 0.891 at epoch 11
ep 12 | train acc 0.965 loss 0.094 | val acc 0.919 loss 0.274 | macroF1 0.879 | lr 7.17e-05 | val_time 2.1s | ep_time 24.5s
ep 13 | train acc 0.968 loss 0.086 | val acc 0.919 loss 0.292 | macroF1 0.866 | lr 6.65e-05 | val_time 2.1s | ep_time 24.4s
ep 14 | train acc 0.971 loss 0.076 | val acc 0.930 loss 0.257 | macroF1 0.889 | lr 6.11e-05 | val_time 2.1s | ep_time 24.4s
ep 15 | train acc 0.975 loss 0.066 | val acc 0.919 loss 0.284 | macroF1 0.878 | lr 5.56e-05 | val_time 1.9s | ep_time 24.5s
ep 16 | train acc 0.976 loss 0.069 | val acc 0.931 loss 0.247 | macroF1 0.891 | lr 5.00e-05 | val_time 2.2s | ep_time 24.5s
ep 17 | train acc 0.977 loss 0.061 | val acc 0.913 loss 0.295 | macroF1 0.881 | lr 4.44e-05 | val_time 2.1s | ep_time 24.2s
ep 18 | train acc 0.979 loss 0.051 | val acc 0.930 loss 0.286 | macroF1 0.888 | lr 3.89e-05 | val_time 2.2s | ep_time 24.5s
ep 19 | train acc 0.984 loss 0.042 | val acc 0.934 loss 0.283 | macroF1 0.892 | lr 3.35e-05 | val_time 2.1s | ep_time 24.3s
[info] new best val macro-F1 0.892 at epoch 19
ep 20 | train acc 0.986 loss 0.040 | val acc 0.928 loss 0.286 | macroF1 0.892 | lr 2.83e-05 | val_time 2.1s | ep_time 24.5s
ep 21 | train acc 0.986 loss 0.036 | val acc 0.942 loss 0.253 | macroF1 0.909 | lr 2.34e-05 | val_time 2.2s | ep_time 24.7s
[info] new best val macro-F1 0.909 at epoch 21
ep 22 | train acc 0.987 loss 0.035 | val acc 0.938 loss 0.262 | macroF1 0.904 | lr 1.88e-05 | val_time 2.1s | ep_time 24.4s
ep 23 | train acc 0.988 loss 0.029 | val acc 0.941 loss 0.247 | macroF1 0.909 | lr 1.46e-05 | val_time 2.2s | ep_time 24.7s
ep 24 | train acc 0.991 loss 0.025 | val acc 0.936 loss 0.270 | macroF1 0.906 | lr 1.09e-05 | val_time 1.9s | ep_time 24.3s
ep 25 | train acc 0.989 loss 0.027 | val acc 0.937 loss 0.257 | macroF1 0.906 | lr 7.66e-06 | val_time 2.0s | ep_time 24.3s
ep 26 | train acc 0.991 loss 0.024 | val acc 0.936 loss 0.267 | macroF1 0.901 | lr 4.95e-06 | val_time 2.0s | ep_time 24.4s
ep 27 | train acc 0.991 loss 0.022 | val acc 0.939 loss 0.262 | macroF1 0.905 | lr 2.81e-06 | val_time 2.1s | ep_time 24.5s
ep 28 | train acc 0.992 loss 0.023 | val acc 0.939 loss 0.260 | macroF1 0.904 | lr 1.25e-06 | val_time 2.2s | ep_time 24.4s
ep 29 | train acc 0.993 loss 0.021 | val acc 0.940 loss 0.259 | macroF1 0.906 | lr 3.14e-07 | val_time 2.0s | ep_time 24.4s
ep 30 | train acc 0.992 loss 0.021 | val acc 0.940 loss 0.259 | macroF1 0.906 | lr 0.00e+00 | val_time 2.1s | ep_time 24.4s
[info] saved curves.png

Validation report:
              precision    recall  f1-score   support

        BCNH      0.982     0.957     0.970       117
        BLSK      0.971     0.985     0.978        67
        BRPE      1.000     0.990     0.995       200
       BRPEC      1.000     0.921     0.959        38
        CAEG      0.975     0.991     0.983       117
        GBHE      0.956     0.995     0.975       197
        GREG      0.714     0.778     0.745        45
        LAGU      0.990     0.990     0.990       200
       MEGRT      0.714     0.658     0.685        38
        MTRN      0.943     0.825     0.880       200
      OTHERS      0.762     0.889     0.821        18
        OTHR      0.810     0.850     0.829        20
        REEG      0.968     0.987     0.977       153
      REEGWM      0.931     0.931     0.931        29
        ROSP      0.982     0.982     0.982       110
        ROTE      0.847     0.940     0.891       200
        SATE      0.936     0.973     0.954        75
        SNEG      0.667     0.706     0.686        17
        TRHE      0.991     0.975     0.983       119
        WHIB      0.952     0.895     0.923       200
       WHIBC      0.926     1.000     0.962        25

    accuracy                          0.942      2185
   macro avg      0.906     0.915     0.909      2185
weighted avg      0.944     0.942     0.942      2185

Validation report macro-F1: 0.909
Validation report mAP (macro, one-vs-rest): 0.949

Test report:
              precision    recall  f1-score   support

        BCNH      0.959     0.967     0.963       121
        BLSK      1.000     1.000     1.000       200
        BRPE      0.995     0.975     0.985       200
       BRPEC      0.949     0.949     0.949        39
        CAEG      0.931     0.989     0.959        95
        GBHE      0.950     0.993     0.971       135
        GREG      0.845     0.790     0.817        62
        LAGU      0.980     0.985     0.983       200
       MEGRT      0.630     0.725     0.674        40
        MTRN      0.988     0.805     0.887       200
      OTHERS      0.864     0.864     0.864        22
        OTHR      0.900     0.871     0.885        31
        REEG      0.976     0.982     0.979       168
      REEGWM      0.833     0.857     0.845        35
        ROSP      1.000     0.984     0.992        64
        ROTE      0.830     0.955     0.888       200
        SATE      0.866     0.983     0.921        59
        SNEG      0.656     0.913     0.764        23
        TRHE      0.987     0.987     0.987       150
        WHIB      0.972     0.860     0.912       200
       WHIBC      0.909     1.000     0.952        10

    accuracy                          0.939      2254
   macro avg      0.906     0.925     0.913      2254
weighted avg      0.944     0.939     0.940      2254

Test report macro-F1: 0.913
Test report mAP (macro, one-vs-rest): 0.953
[info] saved val_test_cms.png
